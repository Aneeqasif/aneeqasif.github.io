/* PondPilot widget overrides tuned to the Expressive Code palette. */
:root,
:root.dark {
  --pondpilot-bg-color: var(--codeblock-bg) !important;
  --pondpilot-output-bg: oklch(from var(--codeblock-bg) calc(l + 0.001) c h) !important;
  --pondpilot-controls-bg: var(--codeblock-topbar-bg) !important;
  --pondpilot-table-border: oklch(from var(--pondpilot-output-bg) calc(l + 0.1) c h) !important;
  --pondpilot-table-header-bg: oklch(from var(--pondpilot-output-bg) calc(l - 0.022) c h) !important;
  --pondpilot-table-row-alt: oklch(from var(--pondpilot-output-bg) calc(l - 0.02) c h) !important;
  --pondpilot-table-row-hover: oklch(from var(--pondpilot-output-bg) calc(l + 0.035) c h) !important;
  --pondpilot-table-header-text: oklch(0.85 0.02 var(--hue)) !important;
  --pondpilot-table-hover: var(--pondpilot-table-row-hover) !important;

  --pondpilot-editor-bg: var(--codeblock-bg) !important;
  --pondpilot-editor-focus-bg: oklch(0.19 0.02 var(--hue)) !important;
  --pondpilot-text-color: oklch(0.85 0.02 var(--hue)) !important;
  --pondpilot-editor-text: oklch(0.9 0.01 var(--hue)) !important;
  --pondpilot-muted-text: oklch(0.6 0.03 var(--hue)) !important;
  --pondpilot-scrollbar: oklch(0.37 0.035 var(--hue)) !important;
  --pondpilot-border-color: oklch(0.25 0.03 var(--hue) / 0.3) !important;
  --pondpilot-primary-bg: var(--codeblock-bg) !important;
  --pondpilot-primary-text: oklch(0.95 0.01 var(--hue)) !important;
  --pondpilot-secondary-bg: oklch(0.25 0.03 var(--hue) / 0.5) !important;
  --pondpilot-secondary-text: oklch(0.8 0.05 var(--hue)) !important;
  --pondpilot-secondary-hover: oklch(0.3 0.04 var(--hue)) !important;
  --pondpilot-error-text: oklch(0.7 0.18 25) !important;
  --pondpilot-error-bg: oklch(0.25 0.08 25 / 0.3) !important;
  --pondpilot-error-border: oklch(0.4 0.12 25 / 0.5) !important;
  --pondpilot-font-family: var(--ui-secondary-font,
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      sans-serif) !important;
  --pondpilot-editor-font-family: var(--post-mono-font,
      "Iosevka",
      ui-monospace,
      SFMono-Regular,
      Menlo,
      Monaco,
      Consolas,
      "Liberation Mono",
      "Courier New",
      monospace) !important;
  --pondpilot-font-size: 1rem !important;
  --pondpilot-editor-font-size: 1rem !important;
  --pondpilot-button-font-size: 13px !important;
  --pondpilot-metadata-font-size: 14px !important;

  /* Syntax highlighting colors arrive via JS at runtime. */
}

.pondpilot-widget ::selection {
  background: var(--codeblock-selection) !important;
  color: inherit;
}

.pondpilot-widget-wrapper {
  position: relative;
  margin: 2rem 0;
}

.custom-md .pondpilot-widget-wrapper {
  margin: 2rem 0;
}

.pondpilot-widget {
  background: var(--pondpilot-bg-color) !important;
  border: none !important;
  border-radius: 0.75rem !important;
  overflow: hidden !important;
  box-shadow: none !important;
}

.pondpilot-button-container {
  display: flex !important;
  gap: 8px !important;
  padding: 3px !important;
}

.pondpilot-run-button,
.pondpilot-reset-button {
  border-radius: 0.6rem !important;
  font-family: "JetBrains Mono Variable", ui-monospace, SFMono-Regular, Menlo,
    Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-weight: bold !important;
}

.pondpilot-run-button {
  background: var(--btn-regular-bg) !important;
  color: var(--btn-content) !important;
}

.pondpilot-run-button:hover {
  color: var(--btn-regular-bg) !important;
  background: var(--btn-content) !important;
}

.pondpilot-reset-button {
  background: var(--pondpilot-secondary-bg) !important;
  color: var(--pondpilot-secondary-text) !important;
}

.pondpilot-reset-button:hover {
  background: var(--pondpilot-secondary-hover) !important;
}

.pondpilot-editor {
  background: var(--pondpilot-editor-bg) !important;
}

.pondpilot-editor pre {
  background: var(--pondpilot-editor-bg) !important;
  font-family: var(--pondpilot-editor-font-family) !important;
  font-size: var(--pondpilot-editor-font-size) !important;
  line-height: 1.7rem !important;
  font-weight: 400 !important;
  color: var(--pondpilot-editor-text) !important;
  border-radius: 0.75rem !important;
  outline: none !important;
  /* Dont wrap code in the text area */
  white-space: pre !important;
  overflow-x: auto !important;
  word-wrap: normal !important;
  word-break: normal !important;
}

/* Editor focus */
.pondpilot-editor pre:focus {
  outline: 2px solid var(--primary) !important;
  outline-offset: -2px !important;
}

/* Editor focus when output visible */
.pondpilot-widget:has(.pondpilot-output-content:not(:empty)) .pondpilot-editor pre:focus {
  border-radius: 0.75rem 0.75rem 0 0 !important;
}

.pondpilot-output {
  background: var(--pondpilot-output-bg) !important;
  border-top-color: var(--pondpilot-border-color) !important;
  display: flex !important;
  flex-direction: column !important;
}

.pondpilot-output-content {
  padding: 0 !important;
  margin: 0 !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Metadata to bottom */
.pondpilot-output-content>div:first-child {
  order: 2 !important;
  margin: 8px 0 !important;
  padding: 0 12px !important;
}

/* Table first */
.pondpilot-output-content>table {
  order: 1 !important;
}

.pondpilot-output table {
  background: var(--pondpilot-output-bg) !important;
  font-family: var(--pondpilot-editor-font-family) !important;
  font-size: var(--pondpilot-font-size) !important;
  border: none !important;
  border-radius: 0 !important;
  margin: 0 !important;
}

/* Table header */
.pondpilot-output th {
  background: var(--pondpilot-table-header-bg) !important;
  color: var(--pondpilot-table-header-text) !important;
  font-family: var(--pondpilot-editor-font-family) !important;
  font-size: 0.95rem !important;
  font-weight: 600 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  border-bottom: 2px solid var(--pondpilot-border-color) !important;
}

/* Table cells */
.pondpilot-output td {
  color: var(--pondpilot-text-color) !important;
  font-size: 0.925rem !important;
}

/* Table cells */
.pondpilot-output td {
  color: var(--pondpilot-text-color) !important;
  font-size: 0.925rem !important;
  border-bottom: 1px solid var(--pondpilot-table-border) !important;
}

/* Zebra striping */
.pondpilot-output tbody tr:nth-child(even) {
  background: var(--pondpilot-table-row-alt) !important;
}

/* Row hover */
.pondpilot-output tbody tr:hover {
  background: var(--pondpilot-table-row-hover) !important;
}

.pondpilot-editor .pondpilot-keyword {
  font-weight: 700 !important;
}

/* ============================================================================
 * SECTION 8: ERROR STYLING
 * Error messages display
 * ============================================================================ */

.pondpilot-output-content .pondpilot-error {
  margin: 140px 8px !important;
  background: var(--pondpilot-error-bg) !important;
  border: 1px solid var(--pondpilot-error-border) !important;
  border-radius: 11px !important;
  color: var(--pondpilot-error-text) !important;
  font-family: var(--pondpilot-editor-font-family) !important;
  font-size: 0.9rem;
  line-height: 1.5 !important;
  word-break: break-word !important;
  white-space: pre-wrap !important;
}

.sql-hl-keyword {
  font-weight: 400 !important;
}

.sql-hl-comment {
  font-style: normal !important;
}

/* ============================================================================
 * SECTION 9: SCROLLBAR STYLING
 * Custom scrollbar for PondPilot results
 * ============================================================================ */

.pondpilot-widget * {
  scrollbar-color: var(-pondpilot-scrollbar) transparent;
  scrollbar-width: thin;
}

.pondpilot-widget *::-webkit-scrollbar-track {
  background: transparent;
}

.pondpilot-widget *::-webkit-scrollbar-thumb {
  background-color: var(--pondpilot-border-color);
}