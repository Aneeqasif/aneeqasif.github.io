@import "./main.css";

.custom-md {
  h1 {
    @apply text-3xl;
  }

  h2 {
    font-size: 1.5rem;
    line-height: 2rem;
  }

  h3 {
    font-size: 1.25rem;
    line-height: 1.75rem;
  }

  h4 {
    font-size: 1.125rem;
    line-height: 1.75rem;
  }

  h5 {
    font-size: 1rem;
    line-height: 1.5rem;
  }

  h6 {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    .anchor {
      @apply transition -m-0.5 ml-[0.2ch] p-0.5 select-none opacity-0 no-underline !important;

      .anchor-icon {
        @apply mx-[0.45ch] !important;
      }
    }

    &:hover {
      .anchor {
        @apply opacity-100 !important;
      }
    }
  }

  a:not(.no-styling):not(.marquee-item) {
    @apply relative bg-none link font-medium text-[var(--primary)] underline decoration-[var(--link-underline)] decoration-1 decoration-dashed underline-offset-4;
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
    /* display: inline-block; */

    &:hover,
    &:active {
      @apply decoration-transparent;
      background: var(--btn-plain-bg-hover);
      border-bottom: 1px dashed var(--link-hover);
      text-decoration: none;
    }
  }

  code {
    @apply bg-[var(--inline-code-bg)] text-[var(--inline-code-color)] px-1 py-0.5 rounded-md overflow-hidden;

    font-family: var(
      --post-mono-font,
      "Iosevka",
      ui-monospace,
      SFMono-Regular,
      Menlo,
      Monaco,
      Consolas,
      "Liberation Mono",
      "Courier New",
      monospace
    );
    font-size: 0.95em;
    /* Adjust: 0.85em (smaller) to 1em (same as text) */
    font-weight: 400;

    /* Adjust: 300 (light), 400 (normal), 500 (medium), 600 (semibold), 700 (bold) */
    &:before {
      content: none;
    }

    &:after {
      content: none;
    }

    counter-reset: line;

    span.line {
      &:before {
        @apply text-white/25 mr-4 w-4 inline-block;
        content: counter(line);
        counter-increment: line;
        direction: rtl;
      }

      &:last-child:empty,
      &:last-child:has(> span:empty:only-child) {
        display: none;
      }
    }
  }

  .copy-btn {
    all: initial;
    @apply btn-regular-dark opacity-0 shadow-lg shadow-black/50 absolute active:scale-90 h-8 w-8 top-3 right-3 text-sm rounded-lg transition-all ease-in-out z-20 cursor-pointer;
  }

  .frame:hover .copy-btn {
    opacity: 1;
  }

  .copy-btn-icon {
    @apply absolute top-1/2 left-1/2 transition -translate-x-1/2 -translate-y-1/2 w-4 h-4 fill-white pointer-events-none;
  }

  .copy-btn .copy-icon {
    @apply opacity-100 fill-white dark:fill-white/75;
  }

  .copy-btn.success .copy-icon {
    @apply opacity-0 fill-[var(--deep-text)];
  }

  .copy-btn .success-icon {
    @apply opacity-0 fill-white;
  }

  .copy-btn.success .success-icon {
    @apply opacity-100;
  }

  .expressive-code {
    @apply my-4;

    ::selection {
      @apply bg-[var(--codeblock-selection)];
    }
  }

  ul,
  ol {
    li::marker {
      @apply text-[var(--primary)];
    }
  }

  blockquote {
    @apply not-italic border-transparent relative;
    font-weight: inherit;

    &:before {
      @apply content-[''] absolute -left-1 block transition bg-[var(--btn-regular-bg)] h-full w-1 rounded-full;
    }

    /* Remove the double quotes from default styles */
    p:before,
    p:after {
      @apply content-none;
    }
  }

  .katex-display-container {
    max-width: 100%;
    overflow-x: auto;
    margin: 1em 0;
  }

  /* ========================================
     Default Image Styling
     Prevents images from overwhelming viewport
     ======================================== */

  img {
    @apply max-w-full h-auto rounded-lg;
    /* Prevent super tall images from taking over */
    max-height: 80vh;
  }

  /* Marquee images handled by marquee.css - don't override */
  .marquee-item img {
    height: 100%;
    width: auto;
    max-width: none;
    max-height: none;
    border-radius: 7px;
  }

  /* Block images (image as only child of paragraph) - center them */
  p > img:only-child {
    @apply block mx-auto my-6;
  }

  /* Images with siblings in paragraph - inline behavior */
  p > img:not(:only-child) {
    @apply inline-block align-middle my-1 rounded;
    max-height: 60vh;
  }

  /* Figure element styling (for future directive support) */
  figure {
    @apply my-6 mx-0;

    img {
      @apply rounded-lg mx-auto block;
    }

    figcaption {
      @apply text-center text-sm text-black/50 dark:text-white/50 mt-2 italic;
    }
  }
}
